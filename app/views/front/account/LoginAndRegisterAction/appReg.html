<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>免费注册</title>
    <link rel="stylesheet" href="https://apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css">
    <style type="text/css">
    	body{background-color:#FFF;background-image: url("/public/images/reg-bg.png");background-size: cover;width: 100%;height: 100%;display: block;}
    	form{margin: 180px auto 0 auto;/* max-width: 70%; */padding:0 16px;}
    	.input-group-addon{background: #FFF;border-right: none;padding: 6px;}
    	.reco{border-left:none;}
    	.form-control{box-shadow:none;transition:none;}
    	.footer{text-align: center;color: #FFF;margin: 30px 0;font-size: 11px;}
    	.footer img{width: 40px;margin-right: 10px;}
    	.footer p{margin-top: 10px;}
    	
    </style>
  </head>
<body>
#{form @front.account.loginAndRegisterAction.appRegMobile(), id:'appReg'}
  <div class="form-group">
    <input type="tel" id="mobile" name="mobile" class="form-control input-lg" placeholder="手机号">
  </div>
  <div class="form-group">
    <input type="hidden" name="name" id="name"  class="form-control input-lg" placeholder="用户名">
  </div>
  <div class="form-group">
    <input type="password" id="password" name="password" class="form-control input-lg" placeholder="登录密码(由6-20位的数字、字母组成)">
  </div>
  <div class="form-group">
    <div class="row">
	  <div class="col-xs-6">
	    <input type=tel name="smsCode" class="form-control input-lg" placeholder="短信验证码">
	  </div>
	  <div class="col-xs-6">
	    <button type="button" id="sendSmsCode" onclick="sendCode()" class="btn btn-primary btn-block btn-lg">获取验证码</button>
	  </div>
	</div>
  </div>
  <div class="form-group">
    <input type="text" class="form-control reco-user input-lg" name="recommendName" value="推荐人：${recommendName}" readonly="readonly"  style="color:#888">
  </div>
  <button type="button" class="btn btn-default btn-block reg_btn btn-lg" id="reg">注  册</button>
  
 <div class="form-group" style="margin-top:20px;">
    <div class="row">
	  <div class="col-xs-6">
	    <a href="@{app.AppController.download()}" class="btn btn-default btn-block btn-lg" style="color:#888">app下载</a>
	  </div>
	  <div class="col-xs-6">
	    <a href="@{front.home.HomeAction.home}" class="btn btn-default btn-block btn-lg" style="color:#888">官网主页</a>
	  </div>
	</div>
  </div>
 #{/form}
 

<div class="footer">
	<p>版权所有 &copy; 亿亿理财安全系统 沪ICP备案15054793号</p>
</div>

</body>
<script src="@{'/public/javascripts/jquery-2.0.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/common.js'}"></script>
<script type="text/javascript">
var remain = 60;

function countDown() {
  if (remain == 0) {
    remain = 60;
    $("#sendSmsCode").html("点击发送");
    $("#sendSmsCode").attr("onclick", "sendCode();");
    $("#sendSmsCode").attr("style", "cursor:pointer");

    return;
  }

  $("#sendSmsCode").html("" + remain-- + "秒后重发");
  setTimeout("countDown()",1000);
}
function sendCode() {
	  var mobile = $("#mobile").val();
	  if(mobile == "") {
	    alert("请输入手机号码后，再获取验证码");
	    return;
	  }
	  
	  $.ajax({
		  url : "@{sendSmsCode()}",
		  type : "POST",
		  data : {
			  "mobile" : mobile,
			  'send' : true
		  },
		  dataType:'json',
		  success : function(data) {
			  if(data.code < 0){
				  alert(data.msg);
			  }else{
				  countDown();
				  $("#sendSmsCode").attr("onclick", "void(0);");
				  $("#sendSmsCode").attr("style", "cursor: default");
			  }
			},
		  error : function() {
		    alert("对不起，出现错误!");
		  }
		 });
	}
$(function(){
	
	$('#reg').click(function(){
		if($(this).attr('disabled') == 'disabled'){
			return;
		}
		$(this).attr('disabled','disabled');
		
		$("#name").val("zzy"+$("#mobile").val());
		
		$.ajax({
			  url : "@{front.account.LoginAndRegisterAction.appRegMobile()}",
			  type : "POST",
			  data : $('#appReg').serialize(),
			  dataType:'json',
			  success : function(data) {
				  if(data.code < 0){
					  alert(data.msg);
					  $('#reg').removeAttr('disabled');
				  }else{
					  alert('注册成功');
					  //location.href = 'http://appstore.qiwangyun.com/lab/sp2p_Test/download.html';
					  location.href = '@{app.AppController.download()}';
				  }
				},
			  error : function() {
			    alert("对不起，出现错误!");
			  }
			 });
		
	});
	
	
	//导航js
	$('.p_hebtn').click(function(){
		if ($('.p_nav').is(':hidden')) {
			$(this).children('span').children('i').animate({'top': '17px'},100, function() {
				$('.p_hebtn').children('span').addClass('click');
				$('.p_nav').slideDown();
			});
		}else{
			$(this).children('.p_hxtop').children('i').animate({'top': '13px'}, 500);
			$(this).children('.p_hxbot').children('i').animate({'top': '21px'}, 500);
			$('.p_hebtn').children('span').removeClass('click');
			$('.p_nav').slideUp();
		};
	});
	
	//边距处理
	$('.p_ft_link div:last a').css('border-right', 'none');
	//最小高度处理
	var heit = $(window).height();
	$('.p_minheight').css('min-height', heit-201+'px');
	
	//注册 按钮  js
	$('.p_zc_icon').click(function() {
		var ico = $(this).children('i'),
			num = ico.position().left;
		if (num==23) {
			$('#password').attr('type','password');
			ico.animate({left: 0},180, function() {
				$(this).addClass('clicked');
				$('.p_zc_icon').addClass('clicked');
			});
		}else{
			$('#password').attr('type','text');
			$('.p_zc_icon').removeClass('clicked');
			ico.animate({left: '23px'},180, function() {
				$(this).removeClass('clicked');
			});
		};
	});
	//通用选项卡 xxk
	function tab(li,tabox,name){
		li.eq(0).addClass(name);
		tabox.eq(0).show();
		li.click(function(){
			$(this).addClass(name).siblings().removeClass(name);
			tabox.hide().eq($(this).index()).show();
		})
	}
	tab($(".p_lctop div"),$(".p_lctabox"),"on");

})
</script>
</html>
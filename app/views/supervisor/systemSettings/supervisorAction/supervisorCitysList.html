<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>#{get 'title' /}</title>
  <meta name="keywords" content="${currBackstageSet?.seoKeywords}" />
  <meta name="description" content="${currBackstageSet?.seoDescription}" />
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
  <link rel="shortcut icon" type="image/png" href="@{'/public/images/favicon.ico'}" />
  <link rel="stylesheet" type="text/css" href="@{'/public/stylesheets/xfback.css'}" />
  <link rel="stylesheet" type="text/css" href="@{'/public/stylesheets/temp.css'}" />
  <script type="text/javascript" src="@{'/public/javascripts/jquery-2.0.js'}"></script>
  <script type="text/javascript" src="@{'/public/javascripts/index.js'}"></script>
  <script type="text/javascript" src="@{'/public/javascripts/jquery.json-2.4.min.js'}"></script>
  <script charset="utf-8" src="@{'public/javascripts/ajaxfileupload.js'}"></script>
  <script type="text/javascript" src="@{'/public/javascripts/common.js'}"></script>
  <script src="@{'/public/javascripts/laydate/laydate.js'}"></script>    
</head>
<body>
<div class="xn_c_ban_jox xn_c_ban_jox_hk" >
<div class="xf_ht_jr_obu_width">
<!-- 详情-弹出层 -->
  <div class="xn_c_content">
  <table border="0" cellspacing="0" cellpadding="0" class="xf_ht_jr_obu_form xf_ht_jr_obu_formsz">
		<tr>
			<td width="104" align="right" valign="middle"
				class="xf_ht_jr_obttd_l">管理员账号：</td>
			<td><span class="xf_ht_fk_span">${supervisor?.name}</span></td>
			<td width="104" align="right" valign="middle"
				class="xf_ht_jr_obttd_l">管理员姓名：</td>
			<td><span class="xf_ht_fk_span">${supervisor?.reality_name}</span></td>
			<td  width="104" align="right" valign="middle" class="xf_ht_jr_obttd_l">手机号：</td>
			<td><span class="xf_ht_fk_span">${supervisor?.mobile1}</span>
			</td>
		</tr>
		 
	</table>
    <div class="xf_ht_tablelist">
      	<!-- 列表内容 -->
      	<div class="xn_c_content_top">
	      #{table class:"xn_c_content_list", cellspacing:"0", cellpadding:"0", border:"0", }
	      #{tr}
	        #{th width:"5px"}序号#{/th}
	        #{th width:"5px"}可见省#{/th}
	        #{th width:"5px"}可见市#{/th} 
	        #{th width:"5px"}操作#{/th}
	      #{/tr}
	      #{list pageBean?.page}         
	      #{tr tr_index:_index}
	        #{td}<input type="hidden" name="checkedCity" class="checkedCity" value="${_?.city_id}"/>&nbsp;&nbsp;${(pageBean?.currPage - 1)*pageBean?.pageSize + _index}#{/td}
	        #{td}${_?.province}#{/td}
	        #{td}${_?.city}#{/td}  
	        #{td}  
	          <span><a href="javascript:deleteCity('${supervisor?.sign}')" class="xf_ta_onclick">删除</a></span>
	          <input type="hidden" value="${_?.city_id}" id="cityId" />
	        #{/td}
	      #{/tr}
	      #{/list}
	      #{/table}
      	</div>
      	<!-- 列表底部 -->
		<div class="xn_c_content_bottom">
			#{form @supervisor.systemSettings.supervisorAction.supervisorCitysList(), id:'loanCityList'}
        	<input type="hidden" id="sign" name="sign" value="${supervisor?.sign}" />
        	<input type="hidden" name="currPage" id="currPage"/>
        	#{/form}
        	#{page funMethod:"showPage", currPage:pageBean.currPage,pageSize:pageBean.pageSize,totalCount:pageBean.totalCount,theme:2,style:4}
        	#{/page}
		</div>
		<div>
       		<input type="button" value="添 加"class="jbox_ok" onclick="add('${supervisor?.sign}')"/>
       		<input class="jbox_ok" type="button" value="刪 除 全 部" onclick="deleteAll('${supervisor?.sign}')" /> 
		</div>
	  
		</div>
	</div>
 </div>
 </div>
 <!-- <!-- 编辑可见地区列表-->
	<div class="xn_c_ban_jox" id="xf_ht_kjdqlb_ttc" style="display:none;height:400px;overflow:auto;">
	</div> 
</body>
</html>

<script type="text/javascript">
	 
	 function add(sign){
	 	//alert(sign);
		 window.location.href="@{supervisor.systemSettings.supervisorAction.editCitysInit()}?sign="+ sign ;
	 }
	 function toAddCitys(sign){
		 $.ajax({
		      url : "@{supervisor.systemSettings.supervisorAction.editCitysInit()}",
		      type : "GET",
		      data : {
		        "sign" : sign
		      },
		      success : function(data) {
		        if (data.code < 0) {
		          alert(data.msg);
		          return;
		        }
		      
		        var ttc = $("#xf_ht_kjdqlb_ttc");
		        ttc.html(data);
		        $.layer({
		          type: 1,
		          area: ['910', 'auto'],
		          title: '编辑可见用户地区',
		          page: {dom : ttc}
		      	});
		          
		      } ,
		      error : function() {
		        alert("对不起，出现错误!");
		      } 
		    });
	} 
	//单个删除
	function deleteCity(sign){
		var cityId = $("#cityId").val();
		$.ajax({
			url : "@{supervisor.systemSettings.supervisorAction.deleteSupervisorCitys()}",
			type : "POST",
			data : {
		        "sign" : sign,
		        "city_id":cityId
			},
			success : function(data) {
		        if (data.code < 0) {
		          alert(data.msg);
		          return;
		        }
		        if (data.code == 0) {
		        	alert("删除成功！");
			    	location.reload();
				}
			} ,
			error : function() {
				alert("对不起，出现错误!");
			} 
		});
	}
	
	//删除全部
	function  deleteAll(sign){
		var chk_value =[]; 
		//循环遍历
		/* $('input[name="checkedCity"]').each(function(){
			chk_value.push($(this).val()); 
		});	
		
		if(chk_value.length<=0){
			alert("请选择要删除的数据！");
			
		}else{ */
			if(confirm("你确定删除吗？")){
				//var cityIds = chk_value.join(",");
				var url = '@{supervisor.systemSettings.supervisorAction.deleteAllCitys()}';
				$.ajax({
					url : url,
					type : "POST",
					data : {
				        "sign" : sign/* ,
				        "city_ids":cityIds */
					},
					success : function(data) {
				        if (data.code < 0) {
				          alert(data.msg);
				          return;
				        }
				        if (data.code == 0) {
				        	alert("删除成功！");
					    	location.reload();
						}
					} ,
					error : function() {
						alert("对不起，出现错误!");
					} 
				});
				 
			}
		//}
		
	}
	
	function showPage(currPage,pageSize) {
		$("#currPage").val(currPage);
		  $("#loanCityList").submit();  
	}
	
</script>
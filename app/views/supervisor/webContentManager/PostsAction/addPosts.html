#{extends 'common/supervisor.html' /}
#{set title:'帖子管理' /}
<!-- 内容区域 -->
<div class="xn_c_contentwarp">
  <div class="xn_c_contentlist">
  #{include "supervisor/webContentManager/common/leftBar.control"/}
  
  <script type="text/javascript" src="@{'public/javascripts/kindeditor-4.1.7/kindeditor.js'}"></script>
  <link rel="stylesheet" src="@{'public/javascripts/kindeditor-4.1.7/themes/default/default.css'}" />
  <script charset="utf-8" src="@{'public/javascripts/kindeditor-4.1.7/kindeditor-min.js'}"></script>
  <script charset="utf-8" src="@{'public/javascripts/kindeditor-4.1.7/lang/zh_CN.js'}"></script>
  <script   type="text/javascript">  
    var editor;
    KindEditor.ready(function(K) {
      editor = K.create('#TextArea3', {
         cssPath :"@{'public/javascripts/kindeditor-4.1.7/plugins/code/prettify.css'}",
         uploadJson : '@{FileUpload.uploadImage2()}',
      allowFileManager : true,
      allowUpload: true
      });
    });
  </script>
  #{form @submitAdd(),method:'POST',id:'submitadd'}
  <input type="hidden" id="content" name="content" />
 
  <div class="xn_c_content" style="width: 1084px;">
    <div class="xf_content_add">
    <div class="xfht_t_j_y_2">
    <!--右上-->
    <div class="xf_ht_obu_fklm">添加内容</div>
    <!-- 借款标基本信息 -->
    <div class="xf_ht_news_content">
    <div class="xf_ht_news_content_t">
      <table border="0" cellspacing="0" cellpadding="0" class="xf_ht_news_content_t_t">
        <tr>
          <td width="120" align="right" valign="middle" style="padding-right:5px;">类别：</td>
          <td>
            <select class="xfht_t_j_td_1_s" id="typeId" name="typeId">
              <option value="0" >-请选择-</option>
          		#{list items:typeList, as:'typeList'}
		         		<option value="${typeList?.id}">${typeList?.name}</option>
		         	#{/list}
            </select>
            
          </td>
        </tr>
        <tr>
          <td width="120" align="right" valign="middle" style="padding-right:5px;">标题：</td>
          <td>
            <input class="xfht_zr_input" type="text" style="width:600px;" name="title" id="title" maxlength="30">
          </td>
        </tr>
        <tr>
          <td width="120" align="right" valign="middle" style="padding-right:5px;">显示时间：</td>
          <td>
            <input class="xfht_zr_input" type="text" style="width:160px;" name="beginTime" id="startShowTime" class="laydate-icon" onclick="laydate()" style="cursor:pointer">
            <span class="xfht_news_zz_span">作者：</span> 
            <input class="xfht_zr_input" type="text" style="width:160px;" name="author" id="author">
          </td>
        </tr>
        <tr>
          <td width="120" align="right" valign="top" style="padding-right:5px;">内容编辑：</td>
          <td>
            <div class="xf_ht_news_conr">
              <textarea class="xf_ht_jr_obttd_textarea" id="TextArea3"></textarea>
            </div>
          </td>
        </tr>
        <tr>
          <td width="120" align="right" valign="top" style="padding-right:5px;">SEO内链关键词：</td>
          <td>
            <input class="xfht_zr_input" type="text" style="width:600px;" id="keyword" name="keyword" ><br />
            <div class="xf_ht_news_span_two">不超过5个关键词，每个关键词不超过10个字符，为本文的主题词，用逗号隔开</div>
          </td>
        </tr>
      </table>
    </div>
    <div style="padding-left: 128px;height: 30px">
      <input type="checkbox" id="showImage" name="showImage" value="1" style="margin-top: 15px"/>是否显示官网图标
    </div>
    <div class="xf_ht_news_content_button" colspan="4">
      <input class="xf_ht_tcc_button_ok" type="button" value="确定" onClick="contentAdd()">
    </div>
    </div>
    </div>
    </div>
  </div>
  #{/form}
  </div>
</div>
<!-- 内容区域end -->
<script type="text/javascript">
$(function(){
	showHighLight(1,6,23);
})

$("#hiddenTime").hide();
    
      
    
function contentAdd(){
  var words, splits, lenth;
  words = $("#keyword").val(); 

  splits = words.split(",");

  lenth = splits.length;
  var typeId = $("#typeId").val();

  var title = $("#title").val();
  var startShowTime = $("#startShowTime").val();
  var author = $("#author").val();
  var content = editor.html();
  content = replaceAllHTML(content);
  
 
  if(content.length > 20000){
    alert("对不起,新闻内容字数不能超过20000个字符");
    return ;
  }
  
  $("#content").val(encodeURIComponent(content));
    
  if(typeId == 0){
    alert("对不起！请选择类别!");
      
    return ;
  }
  if($.trim(title) == ''){
    alert("对不起！标题不能为空!");
      
    return ;
  }
  if($.trim(author) == ''){
    alert("对不起！作者不能为空!");
      
    return ;
  }
  if($.trim(content) == ''){  
    alert("对不起！新闻内容不能为空!");
      
    return ;
  }
  if($.trim(words) == ''){
    alert("对不起！关键字不能为空！");
      
    return;
  }
  if(lenth > 5){
    alert("关键字不能超过5个词！");
      
    return;
  }
    
  for(var i = 0; i < lenth; i++){
    var wordLenth = splits[i].length;
    if(wordLenth > 10 ){
      alert("每个关键词不超过10个字符");
      return;
    } 
  }
    
  $("#submitadd").submit();
} 
</script>
<script>
  var flagtemp = true;
  function chkRadio(id) {
    id.checked = flagtemp;
    flagtemp = !flagtemp;
  }
</script>
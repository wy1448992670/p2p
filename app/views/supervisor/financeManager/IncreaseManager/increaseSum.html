#{extends 'common/supervisor.html' /}
#{set title:'加息汇总列表' /}
<div class="xn_c_contentwarp">
  <div class="xn_c_contentlist">
    #{include '/supervisor/activity/OperatingActivitiesLeft.control'/}
      <div class="xn_c_content">
	  <div class="xf_ht_tablelist">
		<!-- 搜索 -->
		#{form @increaseSum(), id:'submit'}
		<div class="xf_ht_search">
		  <input type="hidden" id="currPage" name="currPageStr"/>
          <input type="hidden" id="pageSize" name="pageSizeStr"/>
		  <div class="xf_ht_search_l">
			<input type="hidden" id="orderType" name="orderType" value="${page.conditions?.orderType}"/>
			<span id="div_0"><a id="tab_0" onClick="conditonSearch(0)">默认排序<a id="sp0"></a></a></span>
			<span id="div_1"><a id="tab_1" onClick="conditonSearch(1)">放款日期<a id="sp1">↑</a></a></span>
			<span id="div_3"><a id="tab_3" onClick="conditonSearch(3)">下次加息付息日期<a id="sp3">↑</a></a></span>
		  </div>
		</div>
		<div class="xf_ht_search_inon">
		  <div class="xf_ht_search_r">
			<div class="xf_ht_search_xl">
				标的名称/借款人真实姓名：
				<input type="text" class="search_w" id="key" name="keyword" value="${page.conditions?.keyword}">
			</div>
			
			<div class="xf_ht_search_xl">
				放款日期：
			  <input type="text" class="search_time" name="fkStart" id="fkStart" value="${page.conditions?.fkStart}" onclick="laydate()" class="laydate-icon" style="cursor:pointer">
			  <span class="search_timesp">--</span>
			  <input type="text" class="search_time" name="fkEnd" id="fkEnd" value="${page.conditions?.fkEnd}" onclick="laydate()" class="laydate-icon" style="cursor:pointer">  
		    </div>
		    
		    <div class="xf_ht_search_xl">
				下次付息日期：
			  <input type="text" class="search_time" name="fxStart" id="fxStart" value="${page.conditions?.fxStart}" onclick="laydate()" class="laydate-icon" style="cursor:pointer">
			  <span class="search_timesp">--</span>
			  <input type="text" class="search_time" name="fxEnd" id="fxEnd" value="${page.conditions?.fxEnd}" onclick="laydate()" class="laydate-icon" style="cursor:pointer">  
		    </div>
			
			<div class="xf_ht_search_xl">
				标的状态：
			  <select id="select" name="status" class="xf_membill_selectAge">
				<option value="-100" #{if page.conditions.status == -100} selected="selected" #{/if}>全部</option>
				<option value="-99" #{elseif page.conditions.status == -99} selected="selected" #{/elseif}>热销中</option>
				<option value="3" #{elseif page.conditions.status == 3} selected="selected" #{/elseif}>放款审核中</option>
				<option value="4" #{elseif page.conditions.status == 4} selected="selected" #{/elseif}>回款中</option>
				<option value="-98" #{elseif page.conditions.status == -98} selected="selected" #{/elseif}>已回款</option>
				<option value="-97" #{elseif page.conditions.status == -97} selected="selected" #{/elseif}>其他</option>
			  </select>
			</div>
			
			<div class="xf_ht_search_xl">
				<input type="hidden" name="isExport" value="0" id="isExport">
				<input type="submit" class="search_button" value="搜索">
				<input type="submit" class="search_button" onmouseout="clearIsExport();" onclick="download();" value="下载数据">
			</div>
		  </div>
		</div>
		#{/form}
		<!-- 列表内容 -->
		<div class="xn_c_content_top">
		  #{table class:"xn_c_content_list", cellspacing:"0", cellpadding:"0", border:"0", tr_class_odd:"xn_tr_bj"}
			#{tr}
			  #{th}序号#{/th}
			  #{th}标的编号#{/th}
			  #{th}标的名称#{/th}
			  #{th}标的状态#{/th}
			  #{th}放款时间#{/th}
			  #{th}借款人真实姓名#{/th}
			  #{th}借款人电话#{/th}
			  #{th}加息年化利率#{/th}
			  #{th}加息总利息#{/th}
			  #{th}已付利息#{/th}
			  #{th}待付利息#{/th}
			  #{th}加息进度#{/th}
			  #{th}下次加息付息日期#{/th}
			  #{th}下次加息付息金额#{/th}
			  #{th}备注#{/th}
			#{/tr}
			#{list items:page.page, as:'inc'}
			#{tr tr_index:_index}
			  #{td}${(page?.currPage - 1)*page?.pageSize + inc_index}#{/td}
			  #{td}${inc?.bidNo}#{/td}
			  #{td}${inc?.title}#{/td}
			  #{td}
			  	${inc?.statusValue}
			  #{/td}
			  #{td}${inc?.auditTime?.format('yyyy-MM-dd')}#{/td}
			  #{td}${inc?.realityName}#{/td}
			  #{td}${inc?.mobile}#{/td}
			  #{td}${inc?.increaseRate}%#{/td}
			  #{td}${inc?.sumInterest?.format("###,##0.00")}#{/td}
			  #{td}${inc?.realInterest?.format("###,##0.00")}#{/td}
			  #{td}${inc?.toPaid?.format("###,##0.00")}#{/td}
			  #{td}${inc?.periods}#{/td}
			  #{td}${inc?.nextTime?.format('yyyy-MM-dd')}#{/td}
			  #{td}${inc?.nextAmt?.format("###,##0.00")}#{/td}
			  #{td}${inc?.remark}#{/td}
			#{/tr}
			#{/list}
		  #{/table}
		</div>
		<!-- 列表底部 -->
		<div class="xn_c_content_bottom">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;加息总利息合计：${page?.conditions?.sumAmount?.format("###,##0.00")}<br />
		下次加息付息金额合计：${page?.conditions?.nextAmount?.format("###,##0.00")}
		  <div class="page_warp">
			#{page currPage:page.currPage,totalCount:page.totalCount,pageSize:page.pageSize,theme:2,style:4}#{/page}
		  </div>
		</div>
	  </div>
	</div>
  </div>
</div>
<div id="show"></div>
<script type="text/javascript">
$(function(){
	  var mydate = new Date();
	  var now = mydate.getFullYear();
	  var before = now -5;
	  var html = "";
	  
	  for(var  c = now ;c >= before;c--){
		   html += '<option ';

		   if('${page?.conditions?.year}' == c)
			   html += 'selected="selected"';

		   html += ' value="'+c+'">'+c+'</option>';
	  }

	  $("#year").append(html);
	});

function conditonSearch(num){
	  var orderType= ${page.conditions?.orderType};
	  if(orderType == 0){
	    $("#orderType").val(num);
	    $("#submit").submit();
	    return;
	  }
	  var sum = orderType/2;
	  if(sum.toString().indexOf('.') == -1){
	    var sum2 = orderType - 1;
	    $("#orderType").val(num);
	    $("#submit").submit();
	    return;
	  }else{
	    if(orderType == num){
	      $("#orderType").val(num + 1);
	      $("#submit").submit();
	      return;
	    }else{
	      $("#orderType").val(num);
	      $("#submit").submit();
	      return;
	    }
	  }
	}
/* 下载数据 */
function download(){
  $("#isExport").val(1);
  $("#showForm").submit();
}

/* 清除下载数据 */
function clearIsExport(){
  $('#isExport').val(0);
}

  $(function(){	
    /* 高亮显示 */
	showHighLight(9,9,91);
	//条件查询控制样式
	var num= ${page.conditions?.orderType};
    if(num == 0){
      $("#div_0").addClass("xf_sea_isshow");
      
      return;
    }
    var sum = num/2;
    if(sum.toString().indexOf('.') == -1){
      var sum2 = num -1;
      $("#div_"+sum2).addClass("xf_sea_isshow");
      $("#sp"+sum2).html("↓");
      
      return;
    }
    $("#div_"+num).addClass("xf_sea_isshow");
  });
  
  function showPage(currPage, pageSize){
    $("#currPage").val(currPage);
    $("#pageSize").val(pageSize);
    $("#submit").submit();
  }
  
</script>